% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  twocolumn]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[left=1cm,right=1cm,top=6cm,bottom=2.4cm]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\pagenumbering{gobble}
\usepackage{wallpaper}
\ULCornerWallPaper{1}{template_files/pro_tips_pins.png}
\LLCornerWallPaper{1}{template_files/footer_image.png}
\usepackage{enumitem}
\setlist{nosep}
\usepackage{titlesec}
% \titlespacing\section{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
% \titlespacing\subsection{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
% \titlespacing\subsubsection{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\titlespacing{\section}{0pt}{\parskip}{-\parskip}
\titlespacing{\subsection}{0pt}{\parskip}{-\parskip}
\titlespacing{\subsubsection}{0pt}{\parskip}{-\parskip}

\author{}
\date{\vspace{-2.5em}}

\begin{document}

\hypertarget{when-your-workflow-is-clunky}{%
\section{When your Workflow is
Clunky}\label{when-your-workflow-is-clunky}}

Like that one piece of furniture in your living room that you
\emph{need}, but you just can't find a spot for, we often struggle to
find a home for the mid-process artifacts of a data analysis.

Think about some of your workflows. Are you:

\begin{itemize}
\tightlist
\item
  Using \texttt{read.csv()} to bring in emailed data?
\item
  Saving \texttt{.Rds} or \texttt{.RData} objects to be called later?
\item
  Sharing your model or data across multiple apps?
\item
  Redeploying your app every time the supporting data is updated?
\end{itemize}

A ``yes'' to any of the above indicates a solid use case for
\texttt{pins}! Here at RStudio, we developed \texttt{pins} to make
discovering, caching, and sharing resources simpler, all to promote
efficient data workflows.

\hypertarget{what-are-pins}{%
\section{What are Pins?}\label{what-are-pins}}

Just like you'd pin a note to a physical cork board, \texttt{pins} lets
you pin an R or Python object to virtual board where you and others
access it. The virtual board can be on RStudio Connect, S3, Google
Cloud, or your own website, to name a few.

Pins are best suited for objects around a few hundred megabytes. Often
they're made of lightweight or ephemeral data, and they may be relied
upon by multiple assets.

Once pinned, it's much easier to share internal datasets across multiple
assets or across your team. If you're using RStudio Connect, you can
manage who can access your pins with the RStudio Connect access controls
you're already used to.

In this Pro Tip, you'll learn how to pin and retrieve a resource on
RStudio Connect and how to schedule updates to pins so downstream
analyses always current without re-deployment.

\textbf{For a follow-along accompaniment to this Pro Tip with real data
see:}
\url{https://github.com/rstudio/cs_protips/tree/master/example_pins/}

\hypertarget{requirements}{%
\section{Requirements}\label{requirements}}

To utilize \texttt{pins} with Connect make sure you:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Are a Publisher or Administrator on your Connect server.\footnote{Viewers
    can only retrieve pins}
\item
  Have RStudio Connect v 1.7.8 or higher.\footnote{If you're not yet at
    this version but are keen to get started with \texttt{pins}, talk to
    your R Admin and refer to
    \url{https://docs.rstudio.com/connect/admin/server-management/\#upgrading}}
\end{enumerate}

\hypertarget{prework}{%
\section{Prework}\label{prework}}

\textbf{API keys} will let the RStudio IDE communicate with Connect on
our behalf, acting as our credentials. The steps below will save your
credentials for future work, so these are one-time only steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Create an API key from RStudio Connect\footnote{See:
    \url{https://docs.rstudio.com/connect/user/api-keys/}} Give this key
  any name you like, such as \texttt{CONNECT\_API\_KEY} and be certain
  to copy the value to your clipboard.
\item
  Return to the RStudio IDE and save your API key as a system
  environment variable in your .Rprofile file:

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    In the Console, enter \texttt{usethis::edit\_r\_profile()} to open
    your .Rprofile for editing.
  \item
    In the .RProfile, insert
    \texttt{Sys.setenv(\ "CONNECT\_API\_KEY"\ =\ "paste\ key\ value")}.
  \end{enumerate}
\item
  For convenience, save your RStudio Connect server address as a system
  environment variable in your .RProfile as well. Example:
  \texttt{Sys.setenv("CONNECT\_SERVER"\ =\ "https://your-server-address.com/")}
\item
  Save and close the file.
\item
  Restart R (shift + cmd + F10).
\end{enumerate}

If you're using git, it's a good idea to add your .RProfile to your
.gitignore, perhaps with \texttt{usethis::use\_git\_ignore()}, to ensure
you're not publishing your API key to your version control system.

\textbf{Install \texttt{pins}.} The \texttt{pins} package is available
on CRAN, and was at version 0.3.2 at the time of this writing. Install
\texttt{pins} with \texttt{install.packages("pins")}.

Now let's get cooking! üç≥

\hypertarget{pinning-to-rstudio-connect}{%
\section{Pinning to RStudio Connect}\label{pinning-to-rstudio-connect}}

The first step in using pins is to ``Register'' the board. This just
means you're identifying a location where you can store resources.

\textbf{Register Connect as the board} with the following:
\vspace{-4truemm}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pins}\OperatorTok{::}\KeywordTok{board_register}\NormalTok{(}
    \StringTok{"rsconnect"}\NormalTok{, }
    \DataTypeTok{server =} \KeywordTok{Sys.getenv}\NormalTok{(}\StringTok{"CONNECT_SERVER"}\NormalTok{), }
    \DataTypeTok{key =} \KeywordTok{Sys.getenv}\NormalTok{(}\StringTok{"CONNECT_API_KEY"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Now it's time to pin your first resource. Select an object and
\textbf{pin to the rsconnect board with:} \vspace{-4truemm}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my_data <-}\StringTok{ }\NormalTok{iris }\CommentTok{#for example}
\CommentTok{#pin object}
\NormalTok{pins}\OperatorTok{::}\KeywordTok{pin}\NormalTok{(my_data, }
    \DataTypeTok{name =} \StringTok{"my_data"}\NormalTok{,}
    \DataTypeTok{description =} \StringTok{"A lovely pin!"}\NormalTok{,}
    \DataTypeTok{board =} \StringTok{"rsconnect"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The \texttt{board} argument tells the \texttt{pins} package that the
destination is RStudio Connect. Change this argument if you are bound
for other destinations.

With those two commands, you've created your first pin! Congratulations!
Be sure to adjust the \textbf{Access Settings} on your pin in the
RStudio Connect content dashboard if you want to share this pin with
others.

\hypertarget{retrieving-a-pin-from-connect}{%
\section{Retrieving a Pin From
Connect}\label{retrieving-a-pin-from-connect}}

When you view your pin on Connect, you'll notice there is some header
information included for pin retrieval. Let's copy that code into our
analysis and \textbf{retrieve the pin}.

Replace the \texttt{\#\ Retrieve\ Pin} code section below with the
sample from your own pin: \vspace{-4truemm}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pins}\OperatorTok{::}\KeywordTok{board_register}\NormalTok{(}\StringTok{"rsconnect"}\NormalTok{,}
               \DataTypeTok{key =} \KeywordTok{Sys.getenv}\NormalTok{(}\StringTok{"CONNECT_API_KEY"}\NormalTok{),}
               \DataTypeTok{server =} \KeywordTok{Sys.getenv}\NormalTok{(}\StringTok{"CONNECT_SERVER"}\NormalTok{))}

\CommentTok{# Retrieve Pin}
\NormalTok{my_data <-}\StringTok{ }\KeywordTok{pin_get}\NormalTok{(}\StringTok{"your_username/my_data"}\NormalTok{, }
                   \DataTypeTok{board =} \StringTok{"rsconnect"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{schedule-updates-to-your-pin}{%
\section{Schedule Updates to your
Pin}\label{schedule-updates-to-your-pin}}

Up to this point, you've found a home for your mid-process artifacts and
learned how to share them as pins. Now it's time to put your pins on an
update schedule and bask in glory as your analyses automatically refer
to the most current data without requiring redeployment.

To do this, create an R Markdown document that pulls your data, does any
needed processing, and then creates your pin on RStudio Connect. This
will be a supporting ETL (extract, transform, and load) file in your
pipeline. Publish this R Markdown document to Connect. Then, --
\emph{whoa, wait, wha?!\ldots{}}

Were you greeted with a failure to deploy and/or very angry looking
error message when you tried to publish your ETL? This is because the
environment variables in your code (\texttt{CONNECT\_API\_KEY} and
\texttt{CONNECT\_SERVER}) are not saved on the Connect server; they're
only sitting in your .Rprofile in the RStudio IDE.

Don't worry, it's easy to address: In the RStudio Connect content
settings panel for your R Markdown ETL, select the \textbf{Vars} option
and \textbf{create environment variables for \texttt{CONNECT\_API\_KEY}
and \texttt{CONNECT\_SERVER}} - values will appear in plain text until
you hit \textbf{Save}.

Click the \textbf{Refresh Report} button (\emph{the button!} don't just
refresh your browser window) to re-render your document with the new
environment variables in place. Then, go ahead\ldots{} do a little dance
to celebrate! You've published an ETL document that publishes a pin to
Connect!

To finish this little gem, click the \textbf{Schedule} button and
establish a schedule for your ETL (and resulting pin) to refresh. Now
you can point your customer-facing data analysis at this pin to always
have a fresh source of data behind it. Dazzling! ‚ú®

\hypertarget{where-do-i-go-from-here}{%
\section{Where Do I Go From Here?}\label{where-do-i-go-from-here}}

At this point, you know what a pin is, whether pins will be useful for
your workflow, and how to implement them. What next?

Go try \texttt{pins} on your own!

\begin{itemize}
\tightlist
\item
  If you want more hands-on advice with data you can play with yourself,
  work through our detailed pinning example here:
  \url{https://github.com/rstudio/cs_protips/tree/master/example_pins/}
\item
  Looking for inspiration? See this content collection that uses a
  pinned model and datasets as part of a pipeline to support a Shiny app
  in Production. The underlying data in the pin is refreshed on a
  schedule, keeping the Shiny app current:
  \url{https://solutions.rstudio.com/tour/bike_predict/}.
\item
  We also have a ton of resources available for pins right at the
  \texttt{pins} website here: \url{http://pins.rstudio.com/}.
\item
  Any issues? Let us know here:
  \url{https://github.com/rstudio/pins/issues}.
\end{itemize}

Last but not least, let us know how you get on with pins! Reach out to
your Customer Success Representative, or send a note to us at
\href{mailto:sales@rstudio.com}{\nolinkurl{sales@rstudio.com}}.

\end{document}
